# 중첩 클래스, 내부클래스
### 중첩 클래스의 분류
- 정적 중첩 클래스 -> 정적 변수와 같은 위치 `static`
- 내부 클래스 종류
  - 내부 클래스 -> 인스턴스 변수와 같은 위치
  - 지역 클래스 -> 지역 변수와 같은 위치
  - 익명 클래스
  

- 중첩(Nested) : 어떤 다른 것이 내부에 위치하거나 포함되는 구조적인 관계 (ex 마트료시카)
- 내부(Inner) : 나의 내부에 있는 나를 구성하는 요소 (ex 나의 심장)
> 핵심은 바깥 클래스 입장에서 볼 떄 안에 있는 클래스가 나의 인스턴스에 소속이 되는가 되지 않는 가의 차이 이다.

### 중첩 클래스는 언제 사용하나?
내부 클래스를 포함한 모든 중첩 클래스는 특정 클래스가 다른 하나의 클래스 안에서만 사용되거나,
둘이 아주 긴밀하게 연결되어있는 특별한 경우에만 사용한다.
- 논리적 그룹화 : 패키지를 열었을 때 다른 곳에서 사용될 필요가 없는. 특정 클래스가 다른 하나의 클래스에서만 사용되는 경우
- 캡슐화 : 중첩 클래스는 바깥 클래스의 `private`멤버에 접근 할 수 있다. 이렇게 둘을 긴밀하게 연결하고 불필요한 `public` 메서드를 제거할 수 있다.

## 정적 중첩 클래스
- 자신에 멤버에는 당연히 접근 가능
- 바깥 클래스의 인스턴스 멤버에는 접근할 수 없다.
- 바깥 클래스의 클래스 멤버에는 접근할 수 있다.
  - 바깥 클래스의 private static 멤버에는 접근할 수 있다.
> private 접근 제어자
> - private 접근 제어자는 같은 클래스 안에 있을 때만 접근할 수 있다.

> 정적 중첩 클래스는 사실 다른 클래스를 그냥 중첩해 둔 것일 뿐, 서로 아무런 관계가 없다.
> 하지만 private 에 접근할 수 있다는 부분만 다르다.

### 정적 중첩 클래스의 활용
> 내부에 private static class 를 확인하면 이곳에서만 사용되는 것임을 명시적으로 빠르게 이해할 수 있다.
> private 를 하지 않는다면, 외부에서 `바깥클래스.중첩클래스`로 호출 할 수 있다. 하지만 이러한 경우는 중첩 클래스에 용도에 맞지 않을 수 있다. 대부분이러한 경우는 밖으로 뺴는 것이 맞다.

## 내부 클래스
내부 클래스는 바깥 클래스의 인스턴스에 소속이된다.
static이 붙지 않는다

> 정적 중첩 클래스는 바깥 클래스의 인스턴스 멤버 변수에 접근 할 수 없었다. 하지만 내부 클래스는 가능하다.
> 외부 클래스에서 중첩된 내부 클래스를 호출하고 싶은 경우, 바깥 클래스의 인스턴스에 접근해서 생성해야한다.
```java
InnerOuter outer = new InnerOuter();
outer.new Inner();
```
- 내부 클래스는 바깥 클래스의 인스턴스에 소속된다. 따라서 내부 클래스를 생성할 때, 바깥 클래스의 인스턴스 참조가 필요하다.
- 실제 메모리로는 내부 인스턴스는 바깥 인스턴스의 참조값을 보관한다. 이 참조를 통해 바깥 인스턴스의 멤버에 접근할 수 있다.


### 내부 클래스의 활용
> Car와 Engine 리팩토링 예제
> Engine이 내부 클래스로 들어오며 Car를 새로 생성할 필요가 없어진다.
> Car의 get 메서드 또한 Engine에서만 사용되었기 때문에 필요없어진다.
> 
> Engine은 직접 Car의 멤버 변수에 접근하게 되고, private로 외부에서 사용하지 않도록 안전하게 관리할 수 있다.
> 외부에서 Car를 생성할 떄, Engine도 생성되어, 자신을 생성한 Car 인스턴스를 참조하게 된다.
>
> 리팩토링 전에는 불필요한 내용을 외부에 노출한 것으로 캡슐화를 떨어뜨린다.


## 같은 이름의 바깥 변수에 접근하기
- this.value : 내부 나의 변수에 접근
- ShadowingMain.this.value : 바깥 변수에 접근

> 이와 같이 다른 변수들을 가려서 보이지 않게 하는 것을 섀도잉이라한다.
> 하지만 프로그래밍은 명확성이 중요한 만큼, 이름이 겹친다면 다른 이름을 지어주는것이 맞을 수 있다.